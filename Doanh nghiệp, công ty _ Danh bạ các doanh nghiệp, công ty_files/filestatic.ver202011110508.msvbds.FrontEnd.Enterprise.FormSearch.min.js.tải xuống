var cm=new CommonJS.Common,contactsFormSearch={};(function(n){n.FormSearchBroker=function(){function h(h){c(h);a();v();$("#divBusiness").click(function(){n=$("#hdBusiness");r=n.val();r!=null&&r!=""&&$(h.txtKeyword).val("")});$("#divBrCity").click(function(){if(n=$("#hdCity"),t=n.val(),t!==undefined&&t!==""){$(h.txtKeyword).val("");var i={type:"GET",url:e+h.urlListDistrict,data:{cityCode:t},success:function(n){if(u="",u='<li vl="" class="advance-options">Quận/Huyện<\/li>',n!==null&&n.length>0){n.sort(function(n,t){return n.cateOrder-t.cateOrder});for(var t=0;t<n.length;t++)u+='<li vl="'+n[t].districtId+'" data-value="'+n[t].districtAlias+'" class="advance-options">'+n[t].districtName+"<\/li>"}$("#divBrDistrictOptions .advance-options").html(u);o()}};cm.AjaxWrapper(i)}else $("#divBrDistrictOptions .advance-options").html('<li vl="" class="advance-options">Quận/Huyện<\/li>'),$("#divBrDistrict").children("span").children("span").html("Quận/Huyện"),$("#hdDistrict").val("0"),f=0});$(h.txtKeyword).keyup(function(n){if(n.which==13)return s(h),!1});$(h.txtKeyword).blur(function(){i=$(this).val();i!=undefined&&i!=""&&l()});$(h.btnSearch).click(function(){i=$(h.txtKeyword).val();s(h)})}function c(s){var h,c;i=$("#inforPageBroker").data("keyword");r=$("#inforPageBroker").data("domain");t=$("#inforPageBroker").data("city");f=$("#inforPageBroker").data("district");i!=undefined&&i!=""&&$(s.txtKeyword).val(i);r!=undefined&&r>0&&(n=$('#divBusinessOptions .advance-options[vl="'+r+'"]'),$("#divBusinessOptions .advance-options").removeClass("current"),n.addClass("current"),h=n.html(),$("#hdBusiness").children("span").children("span").html(h),$("#hdBusiness").children("input").val(r));t!=undefined&&t!=""&&(n=$('#divBrCityOptions .advance-options[vl="'+t+'"]'),$("#divBrCityOptions .advance-options").removeClass("current"),n.addClass("current"),h=n.html(),$("#divBrCity").children("span").children("span").html(h),$("#divBrCity").children("input").val(t),c={type:"GET",url:e+s.urlListDistrict,data:{cityCode:t},success:function(t){var i,r;if(u="",u='<li vl="" class="advance-options">Quận/Huyện<\/li>',t!==null&&t.length>0)for(t.sort(function(n,t){return n.cateOrder-t.cateOrder}),i=0;i<t.length;i++)u+='<li vl="'+t[i].districtId+'" data-value="'+t[i].districtAlias+'" class="advance-options">'+t[i].districtName+"<\/li>";$("#divBrDistrictOptions .advance-options").html(u);o();f!=undefined&&f>0&&(n=$('#divBrDistrictOptions .advance-options[vl="'+f+'"]'),$("#divBrDistrictOptions .advance-options").removeClass("current"),n.addClass("current"),r=n.html(),$("#divBrDistrict").children("span").children("span").html(r),$("#divBrDistrict").children("input").val(f))}},cm.AjaxWrapper(c))}function l(){$(".comboboxs.advance-select-box").children("div").children("ul").children("li").removeClass("current");$(".comboboxs.advance-select-box").children("div").children("ul").children("li:nth-child(1)").addClass("current");$(".comboboxs.advance-select-box").children("input").val("");$("#divBusiness").children("span").children("span").html("Lĩnh vực");$("#hdBusiness").children("input").val(0);$("#divBrCity").children("span").children("span").html("Tỉnh/Thành phố");$("#divBrDistrict").children("span").children("span").html("Quận/Huyện")}function a(){$("#divBusiness").AdvanceHiddenDropbox({id:"divBusinessOptions",hddValue:"hdBusiness"})}function v(){$("#divBrCity").AdvanceHiddenDropbox({id:"divBrCityOptions",hddValue:"hdCity"})}function o(){$("#divBrDistrict").AdvanceHiddenDropbox({id:"divBrDistrictOptions",hddValue:"hdDistrict"})}function s(n){i=$(n.txtKeyword).val();i=cm.FormatKeyword(i);r=$("#hdBusiness").val();t=$("#hdCity").val();f=$("#hdDistrict").val();y(n.urlRedirect,i,r,t,f)}function y(n,t,i,r,u){var f={type:"GET",url:e+n,data:{search:t,domainId:i,cityCode:r,districtId:u},success:function(n){window.location.href=n}};cm.AjaxWrapper(f)}var n,u="",r=0,t="",f=0,i="",e=$("#staticDomain").data("msvrouter")!==undefined?$("#staticDomain").data("msvrouter"):"";return{Initialize:h}}})(contactsFormSearch);